(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+KxW":function(e,t,a){var s=a("plsg");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,n);s.locals&&(e.exports=s.locals)},R3Qn:function(e,t,a){"use strict";a.r(t);var s=a("hFjC"),n=a("sK6a"),i={name:"pengumuman",metaInfo:{title:"Pengumuman"},data:function(){return{selected:[],isBusy:!1,sortBy:"created_at",sortDesc:!0,perPage:20,loadParams:{},data:[],saveData:{},loading:!1,mode:"add",id:null,titleDeleteModal:"Are you sure?",editorOptions:{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]},{font:[]},{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{direction:"rtl"},{align:[]}],["link","image","video"],["clean"]]},placeholder:"Tulis Pesan!"},fileAttachment:null,detail:{},currentPage:1,listLevel:{},hasAccess:{}}},filters:{formatTanggal:function(e){return e?(e=e.toString()).toUpperCase():""}},components:{LaddaBtn:s.a,SweetModal:n.a,quillEditor:function(){return a.e(2).then(a.t.bind(null,"lT11",7)).then((function(e){return e.quillEditor})).catch((function(){}))}},computed:{user:function(){return this.$store.state.auth.user},penyuluh:function(){var e=this.$store.state.auth.user;return e&&null!=e.penyuluh?1:0}},watch:{currentPage:function(e){this.loadData(e)}},methods:{loadData:function(){var e=this;this.isBusy=!0,this.loadParams.page=this.currentPage,this.loadParams.order_by=this.sortBy,this.loadParams.sort_desc=this.sortDesc,this.loadParams.limit=this.perPage,this.loadParams.params={},null!=this.user.penyuluh&&(this.loadParams.params.status=1),axios.get(this.publicUrl+"api/pengumuman",{params:this.loadParams}).then((function(t){e.data=t.data,e.isBusy=!1})).catch((function(t){e.swr()}))},showModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.index=t,this.$refs["show-pengumuman"].hide(),this.$refs["modal-box"].show(),this.mode=e,"edit"==e){var a=this.data.data[t];this.saveData={subjek:a.subjek,pesan:a.pesan,status:a.status},this.id=a.id}else"add"==e&&(this.saveData={subjek:"",pesan:"",status:1})},hideModal:function(){this.$refs["modal-box"].hide()},process:function(){"add"==this.mode?this.save():this.update()},save:function(){var e=this;this.validate()&&(this.loading=!0,this.saveData.user_id=this.user.id,axios({method:"post",url:this.publicUrl+"api/pengumuman",data:this.saveData}).then((function(t){e.id=t.data.data.id,null!=e.fileAttachment&&e.uploadFile(),e.notif("success","Success","Data berhasil ditambahkan"),e.hideModal(),e.saveData={},e.fileAttachment=null,e.loadData()})).catch((function(t){if(422==t.response.status)for(var a in t.response.data.errors)e.notif("danger","Error",t.response.data.errors[a][0]);else 400==t.response.status?e.notif("warning","Error",t.response.data.message):e.swr()})).then((function(){e.loading=!1})))},update:function(){var e=this;this.validate()&&(this.loading=!0,this.saveData.user_id=this.user.id,axios({method:"put",url:this.publicUrl+"api/pengumuman/"+this.id,data:this.saveData}).then((function(t){null!=e.fileAttachment&&e.uploadFile(),e.notif("success","Success","Data berhasil diperbaharui."),e.hideModal(),e.saveData={},e.fileAttachment=null,e.loadData()})).catch((function(t){if(422==t.response.status)for(var a in t.response.data.errors)e.notif("danger","Error",t.response.data.errors[a][0]);else 400==t.response.status?e.notif("warning","Error",t.response.data.message):e.swr()})).then((function(){e.loading=!1})))},uploadFile:function(){var e=this,t=new FormData;t.append("file",this.fileAttachment),t.append("id",this.id),axios.post(this.publicUrl+"api/pengumuman/file",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.id=null}))},validate:function(){return""==this.saveData.subjek?(this.notif("danger","Error","Subjek tidak boleh kosong."),!1):""!=this.saveData.pesan||(this.notif("danger","Error","Pesan tidak boleh kosong."),!1)},showDetail:function(e){this.detail=this.data.data[e],this.$refs["show-pengumuman"].show()},deleteModal:function(e){this.id=this.data.data[e].id,this.$refs.deleteModalAlert.open()},confirmDelete:function(){var e=this;this.loading=!0,axios({method:"delete",url:this.publicUrl+"api/pengumuman/"+this.id}).then((function(t){e.notif("success","Success","Data berhasil dihapus."),e.$refs.deleteModalAlert.close(),e.loadData()})).catch((function(t){400==t.response.status?e.notif("warning","Error",t.response.data.message):e.swr()})).then((function(){e.loading=!1}))},loadLevel:function(){var e=this;axios.get(this.publicUrl+"api/level").then((function(t){e.listLevel=t.data.data,e.loadAcl()}))},loadAcl:function(){var e=this;if(this.user)if(0!=this.user.level){this.hasAccess={add:!1,edit:!1,delete:!1};var t=this.listLevel.find((function(t){return t.level===e.user.level}));t.rule.find((function(e){return"pengumuman_add"===e.name}))&&(this.hasAccess.add=t.rule.find((function(e){return"pengumuman_add"===e.name})).active),t.rule.find((function(e){return"pengumuman_edit"===e.name}))&&(this.hasAccess.edit=t.rule.find((function(e){return"pengumuman_edit"===e.name})).active),t.rule.find((function(e){return"pengumuman_delete"===e.name}))&&(this.hasAccess.delete=t.rule.find((function(e){return"pengumuman_delete"===e.name})).active)}else this.hasAccess={add:!0,edit:!0,delete:!0}}},created:function(){this.loadLevel(),this.loadData()}},o=(a("1W6T"),a("fLA2"),a("XMgK"),a("S/Rm"),a("KHd+")),l=Object(o.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("b-card",{attrs:{"no-body":""}},[a("b-card-header",{staticClass:"media flex-wrap align-items-center py-4",attrs:{"header-tag":"h4"}},[a("div",{staticClass:"media-body"},[a("i",{staticClass:"ion ion-md-megaphone"}),e._v(" Â  Pengumuman")]),e._v(" "),e.hasAccess.add?a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"primary",title:"Tambah pengumuman",size:"sm"},on:{click:function(t){return e.showModal("add")}}},[a("i",{staticClass:"ion ion-md-add"}),e._v(" Tambah\n                        ")]):e._e()],1),e._v(" "),a("div",{staticClass:"media flex-wrap align-items-center py-1 px-2"},[a("div",{staticClass:"media-body d-flex flex-wrap flex-basis-100 flex-basis-sm-auto"},[a("b-input",{staticStyle:{"max-width":"20rem"},attrs:{size:"sm",placeholder:"Search..."}})],1),e._v(" "),a("div",{staticClass:"text-muted mr-3 ml-auto"},[e._v(e._s(e.data.total>20?e.data.total:e.data.total*e.currentPage)+" of "+e._s(e.data.total))]),e._v(" "),a("div",{staticClass:"d-flex flex-wrap"},[e.data.total?a("b-pagination",{staticClass:"justify-content-center justify-content-sm-end m-0",attrs:{"total-rows":e.data.total,"per-page":e.perPage,size:"sm"},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}}):e._e()],1)]),e._v(" "),a("hr",{staticClass:"border-light m-0"}),e._v(" "),e.data.total>0?a("ul",{staticClass:"list-group messages-list"},e._l(e.data.data,(function(t,s){return a("li",{key:s,staticClass:"list-group-item px-4"},[a("a",{staticClass:"message-sender flex-shrink-1 d-block text-body"},[a("span",{staticClass:"badge badge-dot mr-1",class:"badge-dark"}),e._v("\n                                "+e._s(t.pengirim)+"\n                            ")]),e._v(" "),a("a",{staticClass:"message-subject flex-shrink-1 d-block text-body",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.showDetail(s)}}},[e._v("\n                                | "),a("b",[e._v(e._s(t.subjek))]),e._v(" "),t.file?a("i",{staticClass:"ion ion-md-attach"}):e._e()]),e._v(" "),a("div",{staticClass:"message-date text-muted"},[e.penyuluh?e._e():a("span",{staticClass:"mr2"},[e._v(e._s(1==t.status?"[Publish]":"[Draft]"))]),e._v("\n                                "+e._s(t.waktu)+"\n                            ")]),e._v(" "),e.hasAccess.delete||e.hasAccess.edit?a("div",{staticClass:"ml-2"},[e.hasAccess.edit?a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"primary btn-xs icon-btn md-btn-flat",title:"Edit Pengumuman"},on:{click:function(t){return e.showModal("edit",s)}}},[a("i",{staticClass:"ion ion-md-create"})]):e._e(),e._v(" "),e.hasAccess.delete?a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"danger btn-xs icon-btn md-btn-flat",title:"Hapus Pengumuman"},on:{click:function(t){return e.deleteModal(s)}}},[a("i",{staticClass:"ion ion-md-trash"})]):e._e()],1):e._e()])})),0):a("ul",{staticClass:"list-group"},[a("li",{staticClass:"list-group-item px-4 text-center"},[a("i",[e._v("Belum ada pengumuman")])])])],1)],1)]),e._v(" "),a("b-modal",{ref:"show-pengumuman",attrs:{centered:"",size:"lg","hide-footer":""}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[e._v("\n\t\t\t\t"+e._s(e.detail.subjek)+"\n                "),a("div",{staticClass:"mb-0 mt-1",staticStyle:{"font-size":"12px"}},[e._v("\n                    "+e._s(e.detail.waktu_lengkap)+" - "+e._s(e.detail.pengirim)+"\n                ")])]),e._v(" "),a("div",{domProps:{innerHTML:e._s(e.detail.pesan)}}),e._v(" "),e.detail.file?a("div",[a("a",{attrs:{href:e.detail.file,target:"_blank"}},[e._v("File Attachment")])]):e._e()]),e._v(" "),a("b-modal",{ref:"modal-box",attrs:{centered:"",size:"lg","no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":""}},[a("div",{attrs:{slot:"modal-title"},slot:"modal-title"},[e._v("\n\t\t\t\t"+e._s("add"==e.mode?"Add":"Update")+" Pengumuman \n\t\t\t")]),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col",attrs:{label:"Subjek"}},[a("b-input",{attrs:{placeholder:"Subjek"},model:{value:e.saveData.subjek,callback:function(t){e.$set(e.saveData,"subjek",t)},expression:"saveData.subjek"}})],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col",attrs:{label:"Pesan"}},[e.isIE10Mode?e._e():a("quill-editor",{attrs:{options:e.editorOptions},model:{value:e.saveData.pesan,callback:function(t){e.$set(e.saveData,"pesan",t)},expression:"saveData.pesan"}}),e._v(" "),e.isIE10Mode?a("b-textarea",{staticStyle:{height:"200px"},attrs:{placeholder:"Pesan"},model:{value:e.saveData.pesan,callback:function(t){e.$set(e.saveData,"pesan",t)},expression:"saveData.pesan"}}):e._e()],1)],1),e._v(" "),a("b-form-row",{staticClass:"mt-5"},[a("b-form-group",{staticClass:"col",attrs:{label:"File"}},[a("b-file",{model:{value:e.fileAttachment,callback:function(t){e.fileAttachment=t},expression:"fileAttachment"}}),e._v(" "),null!=e.fileAttachment?a("p",{staticClass:"mt-2"},[e._v("File yang dipilih: "),a("b",[e._v(e._s(e.fileAttachment?e.fileAttachment.name:""))])]):e._e()],1)],1),e._v(" "),a("b-form-row",[a("b-form-group",{staticClass:"col",attrs:{label:"Status"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.saveData.status,expression:"saveData.status"}],attrs:{type:"radio",name:"status",value:"0"},domProps:{checked:0==e.saveData.status,checked:e._q(e.saveData.status,"0")},on:{change:function(t){return e.$set(e.saveData,"status","0")}}}),e._v(" Draft\n                    "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.saveData.status,expression:"saveData.status"}],attrs:{type:"radio",name:"status",value:"1"},domProps:{checked:1==e.saveData.status,checked:e._q(e.saveData.status,"1")},on:{change:function(t){return e.$set(e.saveData,"status","1")}}}),e._v(" Publish\n\t\t\t\t")])],1),e._v(" "),a("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"secondary",title:"Close"},on:{click:function(t){return e.hideModal()}}},[e._v("Close")]),e._v(" "),a("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:e.loading,"data-style":"zoom-out"},nativeOn:{click:function(t){return e.process(t)}}},[e._v("\n\t\t\t\t\t"+e._s("add"==e.mode?"Save":"Update")+"\n\t\t\t\t")])],1)],1),e._v(" "),a("sweet-modal",{ref:"deleteModalAlert",attrs:{icon:"warning",title:"Delete User","hide-close-button":"",blocking:""}},[e._v("\n\t\t\t"+e._s(e.titleDeleteModal)+"\n\t\t\t"),a("template",{staticStyle:{"text-align":"center"},slot:"button"},[a("ladda-btn",{staticClass:"btn btn-primary",attrs:{loading:e.loading,"data-style":"zoom-out"},nativeOn:{click:function(t){return e.confirmDelete()}}},[e._v("Confirm")]),e._v(" "),a("b-btn",{attrs:{variant:"default"},on:{click:function(t){return e.$refs.deleteModalAlert.close()}}},[e._v("Cancel")])],1)],2)],1)}),[],!1,null,null,null);t.default=l.exports},"S/Rm":function(e,t,a){"use strict";a("m5Na")},XMgK:function(e,t,a){"use strict";a("+KxW")},m5Na:function(e,t,a){var s=a("tRiR");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,n);s.locals&&(e.exports=s.locals)},plsg:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,".messages-wrapper {\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  overflow: hidden;\n  -ms-flex: 1 1 100%;\n      flex: 1 1 100%;\n  width: 100%;\n}\n.messages-card {\n  overflow: hidden;\n}\n.messages-wrapper,\n.messages-sidebox {\n  transition: all 0.2s;\n}\n.messages-sidebox {\n  -ms-flex-preferred-size: 100%;\n      flex-basis: 100%;\n  -ms-flex-positive: 0;\n      flex-grow: 0;\n}\n.messages-wrapper .messages-sidebox,\n.messages-card .messages-sidebox {\n  position: fixed;\n  left: calc(-14rem - 1px);\n  z-index: 10;\n  -ms-flex-preferred-size: auto;\n      flex-basis: auto;\n  -ms-flex-positive: 1;\n      flex-grow: 1;\n  width: 14rem;\n}\n.layout-sidenav-100vh .messages-wrapper .messages-sidebox {\n  height: 100vh;\n}\n.messages-card .messages-sidebox {\n  position: absolute;\n  bottom: 0;\n}\n.messages-scroll {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  height: 100%;\n}\n.messages-scroll.messages-content {\n  position: absolute;\n  right: 0;\n  left: 0;\n  width: 100%;\n}\n.messages-list .list-group-item {\n  z-index: auto !important;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n      align-items: center;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  padding-top: 0.375rem;\n  padding-bottom: 0.375rem;\n  width: 100%;\n  border-right: 0;\n  border-left: 0;\n  border-radius: 0;\n}\n.messages-list .list-group-item:first-child {\n  border-top: 0;\n}\n.messages-list .list-group-item:last-child {\n  border-bottom: 0;\n}\n.messages-list .list-group-item > * {\n  padding-top: 0.375rem;\n  padding-bottom: 0.375rem;\n}\n.message-checkbox .custom-control {\n  display: block !important;\n  margin: 0;\n  margin-top: -1px;\n}\n.message-sender {\n  min-width: 10rem;\n}\n.message-subject {\n  width: 100%;\n}\n.message-date {\n  white-space: nowrap;\n}\n.message-attachment {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n      align-items: center;\n  width: 100%;\n}\n.message-attachment > .media-body {\n  min-width: 0;\n}\n.message-attachment-file,\n.message-attachment-img {\n  display: block;\n  -ms-flex-positive: 0;\n      flex-grow: 0;\n  -ms-flex-negative: 0;\n      flex-shrink: 0;\n  width: 4rem;\n  height: 4rem;\n}\n.message-attachment-file {\n  display: inline-block;\n  text-align: center;\n  line-height: 4rem;\n}\n.message-attachment-img {\n  background-color: transparent;\n  background-position: center center;\n  background-size: cover;\n}\n.message-attachment-filename {\n  display: block;\n  overflow: hidden;\n  width: 100%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.light-style .messages-wrapper .messages-sidebox {\n  z-index: 1081;\n}\n.light-style .messages-sidebox-open .messages-sidebox {\n  left: 0;\n}\n.light-style .messages-card .messages-sidebox {\n  background: #fff;\n  box-shadow: 0 0 0 1px rgba(24, 28, 33, 0.075);\n}\n@media (min-width: 576px) {\n.light-style .messages-list .list-group-item {\n    -ms-flex-wrap: nowrap;\n        flex-wrap: nowrap;\n}\n.light-style .message-subject {\n    width: auto;\n}\n.light-style .message-date {\n    margin-left: auto;\n}\n}\n@media (min-width: 768px) {\n.light-style .messages-sidebox {\n    -ms-flex-preferred-size: 14rem;\n        flex-basis: 14rem;\n}\n.light-style .messages-wrapper .messages-sidebox {\n    -ms-flex-preferred-size: auto;\n        flex-basis: auto;\n}\n}\n@media (min-width: 992px) {\n.light-style .messages-wrapper,\n  .light-style .messages-sidebox {\n    transition: none !important;\n}\n.light-style .messages-wrapper {\n    padding-left: 14rem;\n}\n.light-style .messages-sidebox {\n    z-index: auto !important;\n}\n.light-style .messages-wrapper .messages-sidebox {\n    position: absolute;\n    left: 0;\n    z-index: auto;\n}\n.light-style .messages-wrapper .messages-sidebox {\n    height: 100% !important;\n}\n.light-style .messages-card .messages-sidebox {\n    position: static;\n    right: auto;\n    left: auto;\n    -ms-flex-positive: 0;\n        flex-grow: 0;\n    height: auto;\n}\n}\n",""])},tRiR:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,".ql-container.ql-snow {\n  height: 200px;\n}\n",""])}}]);