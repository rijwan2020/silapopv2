(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{Y2W2:function(i,t,a){"use strict";a.r(t);var s={name:"laporan-produksi",metaInfo:{title:"Laporan Produksi"},data:function(){return{data:[],isBusy:!1,pilihLevel:"Semua",hasAccess:{},tahun:"",pilihJenis:"Pilih",pilihKomoditi:"Pilih",komoditiList:{},judul:"Provinsi Jawa Barat",pilihKota:"Pilih",kotaList:{},kecamatanList:{},pilihKecamatan:"Pilih",isKoordinatorKota:!1,isKoordinatorKec:!1,listBulan:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],field_nama:"Kota/Kabupaten",field_komoditi:"Semua Komoditi"}},computed:{user:function(){return this.$store.state.auth.user},penyuluh:function(){var i=this.user;return!(!i||null==i.penyuluh)},tahunList:function(){for(var i=[],t=(new Date).getFullYear();t>=2016;t--)i.push(t);return i}},filters:{upper:function(i){return i?(i=i.toString()).toUpperCase():""},lower:function(i){return i?(i=i.toString()).toLowerCase():""},capital:function(i){if(!i)return"";for(var t=i.toString().split(" "),a=0;a<t.length;a++)t[a]=t[a][0].toUpperCase()+t[a].substr(1);return i=t.join(" ")}},watch:{tahun:function(){this.loadData()},pilihJenis:function(){this.loadData()},pilihKomoditi:function(i){if(this.field_komoditi="Semua Komoditi","Pilih"!=i){var t=this.komoditiList.find((function(t){return t.id===i}));this.field_komoditi="Komoditi "+t.nama}this.loadData()},pilihKota:function(i){if(this.pilihKecamatan="Pilih","Pilih"==i)this.kecamatanList=[],this.judul="Provinsi Jawa Barat",this.field_nama="Kota/Kabupaten";else{this.loadListKecamatan();var t=this.kotaList.find((function(t){return t.kota_id===i}));this.judul=t.name+", Provinsi Jawa Barat",this.field_nama="Kecamatan"}this.loadData()},pilihKecamatan:function(i){var t=this,a=this.kotaList.find((function(i){return i.kota_id===t.pilihKota}));if(null==a)this.judul="Provinsi Jawa Barat",this.field_nama="Kota/Kabupaten";else if("Pilih"==i)this.judul=a.name+", Provinsi Jawa Barat",this.field_nama="Kecamatan";else{var s=this.kecamatanList.find((function(t){return t.kecamatan_id===i}));this.judul="Kecamatan "+s.name+", "+a.name+", Provinsi Jawa Barat",this.field_nama="Kelurahan/Desa"}this.loadData()}},methods:{loadData:function(){var i=this;this.isBusy=!0;var t={};t.tahun=this.tahun,"Pilih"!=this.pilihJenis&&(t.jenis=this.pilihJenis),"Pilih"!=this.pilihKomoditi&&(t.komoditi_id=this.pilihKomoditi),"Pilih"!=this.pilihKota&&(t.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(t.kecamatan_id=this.pilihKecamatan),axios.get(this.publicUrl+"api/laporan/produksi",{params:t}).then((function(t){i.data=t.data,i.isBusy=!1})).catch((function(t){i.swr()}))},toDetail:function(i){var t={};t.tahun=this.tahun,t.bulan=i,"Pilih"!=this.pilihJenis&&(t.jenis=this.pilihJenis),"Pilih"!=this.pilihKota&&(t.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(t.kecamatan_id=this.pilihKecamatan),this.$router.push({name:"laporan_produksi_detail",params:t})},download:function(){var i=this,t={};t.tahun=this.tahun,"Pilih"!=this.pilihJenis&&(t.jenis=this.pilihJenis),"Pilih"!=this.pilihKomoditi&&(params.komoditi_id=this.pilihKomoditi),"Pilih"!=this.pilihKota&&(t.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(t.kecamatan_id=this.pilihKecamatan),t.user_id=this.user.id,this.notif("info","Success","Data sedang disiapkan, silakan cek secara berkala di menu download"),axios({method:"post",url:this.publicUrl+"api/laporan/produksi/download",data:t}).catch((function(t){if(422==t.response.status)for(var a in t.response.data.errors)i.notif("danger","Error",t.response.data.errors[a][0]);else 400==t.response.status?i.notif("warning","Error",t.response.data.message):i.swr()}))},loadListKota:function(){var i=this;axios.get(this.publicUrl+"api/kota").then((function(t){i.kotaList=t.data.data})).catch((function(t){i.swr()}))},loadListKecamatan:function(){var i=this;axios.get(this.publicUrl+"api/kecamatan",{params:{kota_id:this.pilihKota}}).then((function(t){i.kecamatanList=t.data.data})).catch((function(t){i.swr()}))},loadLevel:function(){var i=this;axios.get(this.publicUrl+"api/level").then((function(t){i.listLevel=t.data.data,i.loadAcl()}))},loadAcl:function(){var i=this;if(this.user)if(0!=this.user.level){this.hasAccess={laporan_produksi_download:!1,laporan_produksi_print:!1};var t=this.listLevel.find((function(t){return t.level===i.user.level}));t&&(t.rule.find((function(i){return"laporan_produksi_download"===i.name}))&&(this.hasAccess.laporan_produksi_download=t.rule.find((function(i){return"laporan_produksi_download"===i.name})).active),t.rule.find((function(i){return"laporan_produksi_print"===i.name}))&&(this.hasAccess.laporan_produksi_print=t.rule.find((function(i){return"laporan_produksi_print"===i.name})).active))}else this.hasAccess={laporan_produksi_download:!0,laporan_produksi_print:!0}},loadKorwil:function(){var i=this;if(this.user){var t=this.user;96==t.level&&axios.get(this.publicUrl+"api/korwil/byUser/"+t.id).then((function(t){i.isKorwil=t.data.data,i.isKoordinatorKota=!0,i.pilihKota=t.data.data.kota_id})).catch((function(t){i.swr()})),95==t.level&&axios.get(this.publicUrl+"api/korwil/byUser/"+t.id).then((function(t){i.isKorwil=t.data.data,i.isKoordinatorKota=!0,i.isKoordinatorKec=!0,i.pilihKota=t.data.data.kota_id,i.pilihKecamatan=t.data.data.kecamatan_id})).catch((function(t){i.swr()}))}},loadKomoditi:function(){var i=this;axios.get(this.publicUrl+"api/komoditas").then((function(t){i.komoditiList=t.data.data})).catch((function(t){i.swr()}))}},created:function(){this.tahun=(new Date).getFullYear(),this.loadData(),this.loadLevel(),this.loadListKota(),this.loadKorwil(),this.loadKomoditi()}},n=a("KHd+"),o=Object(n.a)(s,(function(){var i=this,t=i.$createElement,a=i._self._c||t;return a("div",[i._m(0),i._v(" "),a("b-card",{attrs:{"no-body":""}},[a("div",{staticClass:"text-center"},[a("h4",{staticClass:"mt-3 mb-1"},[a("b",[i._v("Laporan Produksi Tahun "+i._s(i.tahun))])]),i._v(" "),a("h5",{staticClass:"mb-1"},[i._v(i._s(i.field_komoditi)+" - "+i._s("Pilih"==i.pilihJenis?"Sawah dan Ladang":1==i.pilihJenis?"Sawah":"Ladang"))]),i._v(" "),a("h4",[i._v(i._s(i._f("capital")(i._f("lower")(i.judul))))])]),i._v(" "),a("hr",{staticClass:"border-light m-0"}),i._v(" "),a("div",{staticClass:"table-responsive"},[i.isBusy?[a("div",{staticClass:"text-center text-danger my-2"},[a("b-spinner",{staticClass:"align-middle"}),i._v(" "),a("strong",[i._v("Loading...")])],1)]:[a("table",{staticClass:"table table-striped table-bordered"},[a("thead",{staticClass:"text-center"},[a("tr",[a("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[i._v("#")]),i._v(" "),a("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[i._v(i._s(i.field_nama))]),i._v(" "),a("th",{attrs:{colspan:"12"}},[i._v("Bulan [Ton]")]),i._v(" "),a("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[i._v("Jumlah [Ton]")])]),i._v(" "),a("tr",i._l(i.listBulan,(function(t,s){return a("th",{key:s},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return i.toDetail(s+1)}}},[i._v(i._s(t))])])})),0)]),i._v(" "),a("tbody",i._l(i.data.data,(function(t,s){return a("tr",{key:s},[a("td",[i._v(i._s(s+1))]),i._v(" "),a("td",[i._v(i._s(t.nama))]),i._v(" "),i._l(t.bulan,(function(t,s){return a("td",{key:s,staticClass:"text-right"},[i._v("\n                                    "+i._s(t)+"\n                                ")])})),i._v(" "),a("td",{staticClass:"text-right"},[i._v(i._s(t.jumlah))])],2)})),0),i._v(" "),a("tfoot",[a("tr",{staticClass:"text-right"},[a("th",{attrs:{colspan:"2"}},[i._v("Jumlah [Ton]")]),i._v(" "),i._l(i.data.jumlah.data,(function(t,s){return a("th",{key:s},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return i.toDetail(s)}}},[i._v(i._s(t))])])})),i._v(" "),a("th",[i._v(i._s(i.data.jumlah.total))])],2)])])]],2)]),i._v(" "),a("b-card",{staticClass:"px-3 py-2 mt-2",attrs:{"no-body":""}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-1 px-0"},[a("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Tahun"}},[a("b-select",{attrs:{size:"md",options:i.tahunList},model:{value:i.tahun,callback:function(t){i.tahun=t},expression:"tahun"}})],1)],1),i._v(" "),a("div",{staticClass:"col-md-1 px-0"},[a("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Jenis"}},[a("b-select",{attrs:{size:"md"},model:{value:i.pilihJenis,callback:function(t){i.pilihJenis=t},expression:"pilihJenis"}},[a("option",{attrs:{value:"Pilih"}},[i._v("Pilih")]),i._v(" "),a("option",{attrs:{value:"1"}},[i._v("Sawah")]),i._v(" "),a("option",{attrs:{value:"2"}},[i._v("Ladang")])])],1)],1),i._v(" "),a("div",{staticClass:"col-md-2 px-0"},[a("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Komoditi"}},[a("b-select",{attrs:{size:"md"},model:{value:i.pilihKomoditi,callback:function(t){i.pilihKomoditi=t},expression:"pilihKomoditi"}},[a("option",{attrs:{value:"Pilih"}},[i._v("Pilih")]),i._v(" "),i._l(i.komoditiList,(function(t,s){return a("option",{key:s,domProps:{value:t.id}},[i._v("\n                                "+i._s(t.nama)+"\n                            ")])}))],2)],1)],1),i._v(" "),a("div",{staticClass:"col-md-3 px-0"},[a("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Kota"}},[a("b-select",{attrs:{size:"md",disabled:i.isKoordinatorKota},model:{value:i.pilihKota,callback:function(t){i.pilihKota=t},expression:"pilihKota"}},[a("option",{attrs:{value:"Pilih"}},[i._v("Pilih")]),i._v(" "),i._l(i.kotaList,(function(t,s){return a("option",{key:s,domProps:{value:t.kota_id}},[i._v("\n                                "+i._s(t.name)+"\n                            ")])}))],2)],1)],1),i._v(" "),a("div",{staticClass:"col-md-3 px-0"},[a("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Kecamatan"}},[a("b-select",{attrs:{size:"md",disabled:i.isKoordinatorKec},model:{value:i.pilihKecamatan,callback:function(t){i.pilihKecamatan=t},expression:"pilihKecamatan"}},[a("option",{attrs:{value:"Pilih"}},[i._v("Pilih")]),i._v(" "),i._l(i.kecamatanList,(function(t,s){return a("option",{key:s,domProps:{value:t.kecamatan_id}},[i._v("\n                                "+i._s(t.name)+"\n                            ")])}))],2)],1)],1),i._v(" "),a("div",{staticClass:"col-md-2 px-0 text-right"},[i.hasAccess.laporan_produksi_download?a("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mt-3",attrs:{variant:"success",title:"Download Data"},on:{click:function(t){return i.download()}}},[a("i",{staticClass:"ion ion-md-download"}),i._v(" Download\n                    ")]):i._e()],1)])])],1)}),[function(){var i=this.$createElement,t=this._self._c||i;return t("div",{staticClass:"d-flex justify-content-between align-items-center w-100 mb-0 border-bottom"},[t("div",{staticClass:"d-flex align-items-center"},[t("h5",{staticClass:"m-1 d-inline-block text-nowrap font-weight-normal"},[this._v("\n                    Laporan / Produksi\n                ")])])])}],!1,null,null,null);t.default=o.exports}}]);