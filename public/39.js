(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"3c4u":function(t,a,i){"use strict";i.r(a);var s={name:"laporan-htp-area",metaInfo:{title:"Laporan Harga Tingkat Petani"},data:function(){return{data:[],isBusy:!1,pilihLevel:"Semua",hasAccess:{},tahun:"",pilihJenis:"Pilih",judul:"Provinsi Jawa Barat",pilihKota:"Pilih",kotaList:{},kecamatanList:{},pilihKecamatan:"Pilih",isKoordinatorKota:!1,isKoordinatorKec:!1,listBulan:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],field_nama:"Kota/Kabupaten",pilihKomoditi:"Pilih",komoditiList:{},field_komoditi:"Semua Komoditi"}},computed:{user:function(){return this.$store.state.auth.user},penyuluh:function(){var t=this.user;return!(!t||null==t.penyuluh)},tahunList:function(){for(var t=[],a=(new Date).getFullYear();a>=2016;a--)t.push(a);return t}},filters:{upper:function(t){return t?(t=t.toString()).toUpperCase():""},lower:function(t){return t?(t=t.toString()).toLowerCase():""},capital:function(t){if(!t)return"";for(var a=t.toString().split(" "),i=0;i<a.length;i++)a[i]=a[i][0].toUpperCase()+a[i].substr(1);return t=a.join(" ")}},watch:{tahun:function(){this.loadData()},pilihKomoditi:function(t){if(this.field_komoditi="Semua Komoditi","Pilih"!=t){var a=this.komoditiList.find((function(a){return a.id===t}));this.field_komoditi="Komoditi "+a.nama}this.loadData()},pilihKota:function(t){if(this.pilihKecamatan="Pilih","Pilih"==t)this.kecamatanList=[],this.judul="Provinsi Jawa Barat",this.field_nama="Kota/Kabupaten";else{this.loadListKecamatan();var a=this.kotaList.find((function(a){return a.kota_id===t}));this.judul=a.name+", Provinsi Jawa Barat",this.field_nama="Kecamatan"}this.loadData()},pilihKecamatan:function(t){var a=this,i=this.kotaList.find((function(t){return t.kota_id===a.pilihKota}));if(null==i)this.judul="Provinsi Jawa Barat",this.field_nama="Kota/Kabupaten";else if("Pilih"==t)this.judul=i.name+", Provinsi Jawa Barat",this.field_nama="Kecamatan";else{var s=this.kecamatanList.find((function(a){return a.kecamatan_id===t}));this.judul="Kecamatan "+s.name+", "+i.name+", Provinsi Jawa Barat",this.field_nama="Kelurahan/Desa"}this.loadData()}},methods:{loadData:function(){var t=this;this.isBusy=!0;var a={};a.tahun=this.tahun,"Pilih"!=this.pilihKomoditi&&(a.komoditi_id=this.pilihKomoditi),"Pilih"!=this.pilihKota&&(a.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(a.kecamatan_id=this.pilihKecamatan),axios.get(this.publicUrl+"api/laporan/htp/area",{params:a}).then((function(a){t.data=a.data,t.isBusy=!1})).catch((function(a){t.swr()}))},toDetail:function(t){var a={};a.tahun=this.tahun,a.bulan=t,"Pilih"!=this.pilihKomoditi&&(a.komoditi_id=this.pilihKomoditi),"Pilih"!=this.pilihKota&&(a.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(a.kecamatan_id=this.pilihKecamatan),this.$router.push({name:"laporan_htp_area_detail",params:a})},download:function(){var t=this,a={};a.tahun=this.tahun,"Pilih"!=this.pilihKomoditi&&(a.komoditi_id=this.pilihKomoditi),"Pilih"!=this.pilihKota&&(a.kota_id=this.pilihKota),"Pilih"!=this.pilihKecamatan&&(a.kecamatan_id=this.pilihKecamatan),a.user_id=this.user.id,this.notif("info","Success","Data sedang disiapkan, silakan cek secara berkala di menu download"),axios({method:"post",url:this.publicUrl+"api/laporan/htp/area/download",data:a}).catch((function(a){if(422==a.response.status)for(var i in a.response.data.errors)t.notif("danger","Error",a.response.data.errors[i][0]);else 400==a.response.status?t.notif("warning","Error",a.response.data.message):t.swr()}))},loadListKota:function(){var t=this;axios.get(this.publicUrl+"api/kota").then((function(a){t.kotaList=a.data.data})).catch((function(a){t.swr()}))},loadListKecamatan:function(){var t=this;axios.get(this.publicUrl+"api/kecamatan",{params:{kota_id:this.pilihKota}}).then((function(a){t.kecamatanList=a.data.data})).catch((function(a){t.swr()}))},loadLevel:function(){var t=this;axios.get(this.publicUrl+"api/level").then((function(a){t.listLevel=a.data.data,t.loadAcl()}))},loadAcl:function(){var t=this;if(this.user)if(0!=this.user.level){this.hasAccess={laporan_htp_download:!1,laporan_htp_print:!1};var a=this.listLevel.find((function(a){return a.level===t.user.level}));a&&(a.rule.find((function(t){return"laporan_htp_download"===t.name}))&&(this.hasAccess.laporan_htp_download=a.rule.find((function(t){return"laporan_htp_download"===t.name})).active),a.rule.find((function(t){return"laporan_htp_print"===t.name}))&&(this.hasAccess.laporan_htp_print=a.rule.find((function(t){return"laporan_htp_print"===t.name})).active))}else this.hasAccess={laporan_htp_download:!0,laporan_htp_print:!0}},loadKorwil:function(){var t=this;if(this.user){var a=this.user;96==a.level&&axios.get(this.publicUrl+"api/korwil/byUser/"+a.id).then((function(a){t.isKorwil=a.data.data,t.isKoordinatorKota=!0,t.pilihKota=a.data.data.kota_id})).catch((function(a){t.swr()})),95==a.level&&axios.get(this.publicUrl+"api/korwil/byUser/"+a.id).then((function(a){t.isKorwil=a.data.data,t.isKoordinatorKota=!0,t.isKoordinatorKec=!0,t.pilihKota=a.data.data.kota_id,t.pilihKecamatan=a.data.data.kecamatan_id})).catch((function(a){t.swr()}))}},loadKomoditi:function(){var t=this;axios.get(this.publicUrl+"api/komoditashtp").then((function(a){t.komoditiList=a.data.data})).catch((function(a){t.swr()}))}},created:function(){this.tahun=(new Date).getFullYear(),this.loadKomoditi(),this.loadListKota(),this.loadData(),this.loadLevel(),this.loadKorwil()}},n=i("KHd+"),o=Object(n.a)(s,(function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("div",{staticClass:"d-flex justify-content-between align-items-center w-100 mb-0 border-bottom"},[t._m(0),t._v(" "),i("div",{staticClass:"m-1"},[i("router-link",{staticClass:"btn btn-sm btn-info",attrs:{to:"/laporan/htp"}},[t._v("\n                    Laporan Htp Komoditi\n                ")])],1)]),t._v(" "),i("b-card",{attrs:{"no-body":""}},[i("div",{staticClass:"text-center"},[i("h4",{staticClass:"mt-3 mb-1"},[i("b",[t._v("Laporan Harga Tingkat Petani Tahun "+t._s(t.tahun))])]),t._v(" "),i("h5",{staticClass:"mb-1"},[t._v(t._s(t.field_komoditi))]),t._v(" "),i("h4",[t._v(t._s(t._f("capital")(t._f("lower")(t.judul))))])]),t._v(" "),i("hr",{staticClass:"border-light m-0"}),t._v(" "),i("div",{staticClass:"table-responsive"},[t.isBusy?[i("div",{staticClass:"text-center text-danger my-2"},[i("b-spinner",{staticClass:"align-middle"}),t._v(" "),i("strong",[t._v("Loading...")])],1)]:[i("table",{staticClass:"table table-striped table-bordered"},[i("thead",{staticClass:"text-center"},[i("tr",[i("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[t._v("#")]),t._v(" "),i("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[t._v(t._s(t.field_nama))]),t._v(" "),i("th",{attrs:{colspan:"12"}},[t._v("Bulan [Rp/Kg]")]),t._v(" "),i("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[t._v("Rata Rata [Rp/Kg]")]),t._v(" "),i("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[t._v("Min [Rp/Kg]")]),t._v(" "),i("th",{staticClass:"align-middle",attrs:{rowspan:"2"}},[t._v("Max [Rp/Kg]")])]),t._v(" "),i("tr",t._l(t.listBulan,(function(a,s){return i("th",{key:s},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.toDetail(s+1)}}},[t._v(t._s(a))])])})),0)]),t._v(" "),i("tbody",t._l(t.data.data,(function(a,s){return i("tr",{key:s},[i("td",[t._v(t._s(s+1))]),t._v(" "),i("td",[t._v(t._s(a.nama))]),t._v(" "),t._l(a.bulan,(function(a,s){return i("td",{key:s,staticClass:"text-right"},[t._v("\n                                    "+t._s(a)+"\n                                ")])})),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(a.rata_rata))]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(a.min))]),t._v(" "),i("td",{staticClass:"text-right"},[t._v(t._s(a.max))])],2)})),0),t._v(" "),i("tfoot",[i("tr",{staticClass:"text-right"},[i("th",{attrs:{colspan:"2"}},[t._v("Rata Rata [Rp/Kg]")]),t._v(" "),t._l(t.data.average,(function(a,s){return i("th",{key:s},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.toDetail(s)}}},[t._v(t._s(a.rata_rata))])])}))],2),t._v(" "),i("tr",{staticClass:"text-right"},[i("th",{attrs:{colspan:"2"}},[t._v("Min [Rp/Kg]")]),t._v(" "),t._l(t.data.average,(function(a,s){return i("th",{key:s},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.toDetail(s)}}},[t._v(t._s(a.min))])])}))],2),t._v(" "),i("tr",{staticClass:"text-right"},[i("th",{attrs:{colspan:"2"}},[t._v("Max [Rp/Kg]")]),t._v(" "),t._l(t.data.average,(function(a,s){return i("th",{key:s},[i("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return t.toDetail(s)}}},[t._v(t._s(a.max))])])}))],2)])])]],2)]),t._v(" "),i("b-card",{staticClass:"px-3 py-2 mt-2",attrs:{"no-body":""}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-1 px-0"},[i("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Tahun"}},[i("b-select",{attrs:{size:"md",options:t.tahunList},model:{value:t.tahun,callback:function(a){t.tahun=a},expression:"tahun"}})],1)],1),t._v(" "),i("div",{staticClass:"col-md-3 px-0"},[i("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Komoditi"}},[i("b-select",{attrs:{size:"md"},model:{value:t.pilihKomoditi,callback:function(a){t.pilihKomoditi=a},expression:"pilihKomoditi"}},[i("option",{attrs:{value:"Pilih"}},[t._v("Pilih")]),t._v(" "),t._l(t.komoditiList,(function(a,s){return i("option",{key:s,domProps:{value:a.id}},[t._v("\n                                "+t._s(a.nama)+"\n                            ")])}))],2)],1)],1),t._v(" "),i("div",{staticClass:"col-md-3 px-0"},[i("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Kota"}},[i("b-select",{attrs:{size:"md",disabled:t.isKoordinatorKota},model:{value:t.pilihKota,callback:function(a){t.pilihKota=a},expression:"pilihKota"}},[i("option",{attrs:{value:"Pilih"}},[t._v("Pilih")]),t._v(" "),t._l(t.kotaList,(function(a,s){return i("option",{key:s,domProps:{value:a.kota_id}},[t._v("\n                                "+t._s(a.name)+"\n                            ")])}))],2)],1)],1),t._v(" "),i("div",{staticClass:"col-md-3 px-0"},[i("b-form-group",{staticClass:"w-auto m-1",attrs:{label:"Kecamatan"}},[i("b-select",{attrs:{size:"md",disabled:t.isKoordinatorKec},model:{value:t.pilihKecamatan,callback:function(a){t.pilihKecamatan=a},expression:"pilihKecamatan"}},[i("option",{attrs:{value:"Pilih"}},[t._v("Pilih")]),t._v(" "),t._l(t.kecamatanList,(function(a,s){return i("option",{key:s,domProps:{value:a.kecamatan_id}},[t._v("\n                                "+t._s(a.name)+"\n                            ")])}))],2)],1)],1),t._v(" "),i("div",{staticClass:"col-md-2 px-0 text-right"},[t.hasAccess.laporan_htp_download?i("b-btn",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mt-3",attrs:{variant:"success",title:"Download Data"},on:{click:function(a){return t.download()}}},[i("i",{staticClass:"ion ion-md-download"}),t._v(" Download\n                    ")]):t._e()],1)])])],1)}),[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"d-flex align-items-center"},[a("h5",{staticClass:"m-1 d-inline-block text-nowrap font-weight-normal"},[this._v("\n                    Laporan / Harga Tingkat Petani / Area\n                ")])])}],!1,null,null,null);a.default=o.exports}}]);